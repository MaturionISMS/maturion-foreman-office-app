Below is the complete VULNERABILITY_INTEGRATION_MAP_v1.0.md, aligned with:

VULNERABILITY_TRUE_NORTH_v1.0.md

Threat, UE, RA, WRAC, PIT, Control Library modules

Maturion ISMS Integrated Architecture

SRMF full pipeline

RLS and multi-company segmentation

Zero Regression doctrine

This document explains exactly where the Vulnerability Module plugs into the larger SRMF system, both upstream and downstream.

Place in:
/Modules/Risk Management/VulnerabilityModule/VULNERABILITY_INTEGRATION_MAP_v1.0.md

VULNERABILITY_INTEGRATION_MAP_v1.0.md

Vulnerability Module — System Integration Map
Version: 1.0
Prepared for: Maturion ISMS + SRMF Architecture
Role: Define all module-to-module interactions and dependencies

0. INTRODUCTION

The Vulnerability Module is the central pivot of the SRMF pipeline:

Threat → Vulnerability → Unwanted Events (UEs) → Risk Assessment (RA)
→ WRAC → PIT → Remote Assurance → Control Performance → Analytics


This Integration Map documents:

All upstream data sources

All downstream data consumers

Bidirectional interactions

AI-assisted cross-module logic

Data contracts

Workflow sequencing

Validation constraints

This is required for:

Developers

Architects

Threat analysts

RA specialists

Security engineers

QA

Audit/compliance teams

It must always remain in sync with the True North architecture.

1. SYSTEM OVERVIEW — POSITION OF THE VULNERABILITY MODULE
                   ┌──────────────────────────┐
                   │      Threat Module       │
                   │  (TTPs, drift, profiles) │
                   └──────────────┬───────────┘
                                  │
                                  ▼
        ┌──────────────────────────────────────────────────┐
        │           VULNERABILITY MODULE (Current)         │
        │  Mapping | Evidence | TVRE | UEs | Severity      │
        └───────────────┬───────────────┬────────────────┘
                        │               │
                        ▼               ▼
                  ┌──────────┐    ┌──────────┐
                  │   UE     │    │    RA    │
                  │  Engine  │    │  Engine  │
                  └─────┬────┘    └────┬────┘
                        │             │
                        ▼             ▼
                     ┌──────┐    ┌────────┐
                     │WRAC  │    │  PIT   │
                     └──┬───┘    └────────┘
                        │
                        ▼
            ┌────────────────────────────┐
            │ Remote Assurance / CCR /   │
            │ Analytics / Dashboards     │
            └────────────────────────────┘


Vulnerability is link-point for:

threats

unwanted events

RA

WRAC

PIT

control library

architecture

AI engines

Watchdog

2. UPSTREAM DEPENDENCIES

The Vulnerability Module consumes data from:

2.1 Threat Module

Inputs:

Threat profiles

Adversarial / non-adversarial classification

TTPs (MITRE/NIST aligned)

Threat drift values

Threat severity

Threat relevance modifiers

Used in:

TVRE

UE construction

Threat matching for vulnerabilities

Contract:

threat_id
threat_name
threat_type
ttp_list[]
drift_score
relevance_modifier

2.2 Organisational Architecture Module

(Implemented in global ISMS)

Inputs:

Facility

Process

Lifecycle nodes

Node metadata

Used in:

Vulnerability location

Risk contextualisation

UE narrative accuracy

Contract:

node_id
node_name
node_type
parent_node
full_path

2.3 Control Library

Inputs:

Control definitions

Control hierarchy (eliminate/substitute/engineering/admin/PPE)

Control failure modes

Control cost (preliminary vs actual)

Used in:

RA + WRAC Integration

PIT linkage

UEs control recommendations

2.4 ERM Framework

Inputs:

Heatmap

Impact & likelihood scales

Appetite thresholds

Used in:

Severity calibration

WRAC risk matrix contributions

Flagging above-appetite vulnerabilities at node level

3. DOWNSTREAM INTEGRATIONS

(What consumes vulnerability data)

3.1 Unwanted Event Engine (UEG)

UEs are generated from:

valid threat + valid vulnerability combination


Outputs:

UE sentence

UE rating

UE link to RA

Contract pushed:

ue_id
title
sentence
relevant_threat_id
vulnerability_id

3.2 Risk Assessment Engine (RA)

Vulnerability → UE → RA pipeline:

Likelihood modification from vulnerability exploitability

Impact calibration from architecture node

RA record created automatically when UE is approved

Contract pushed:

ra_record_id
likelihood_modifier
impact_modifier
asset_exposure (if provided)

3.3 WRAC

Vulnerability influences WRAC via:

Raw severity

Residual risk prediction

Control sets

Cost impact

ROI contributions

Contract pushed:

wrac_row_id
current_rating
projected_rating
control_set[]
cost_estimates
roi_estimate

3.4 PIT (Project Implementation Tracker)

A vulnerability escalates into PIT when:

Severity ≥ High

Controls required are non-trivial

UE leads to high RA

Watchdog flags persistent issues

Contract pushed:

pit_project_id
controls_required[]
vulnerability_id
expected_progress
current_progress
mitigation_effectiveness

3.5 Remote Assurance (future module)

Vulnerability data will be consumed by:

Control availability monitoring

System uptime evaluations

Real-time mitigated risk tracking

Future Contracts:

control_effectiveness %
system availability %
unmitigated risk % (real-time)

3.6 Analytics Engine

Consumes:

Vulnerability statistics

Node heatmaps

TVRE scores

Exploitability distributions

Architecture vulnerability density

Outputs:

Predictive risk models

Cross-facility benchmarking

Leading indicators

4. BIDIRECTIONAL INTEGRATIONS

Some modules communicate in both directions.

4.1 PIT ↔ Vulnerability

PIT progress updates influence:

Real-time vulnerability mitigation

WRAC residual risk recalculation

RA residual likelihood updates

4.2 Threat Drift ↔ Vulnerability

Threat drift updates cause:

Relevance recalculation

UE regeneration (if needed)

RA recalculation

WRAC update

PIT reassessment

4.3 Control Environment ↔ Vulnerability

Controls implemented:

Reduce vulnerability exploitability

Influence residual risk

Update PUE ranking

5. CROSS-MODULE WORKFLOWS
5.1 Master Workflow

Full SRMF Pipeline

1. Identify Threat
2. Identify Vulnerability
3. Evaluate Threat–Vulnerability Relevance (TVRE)
4. Generate Unwanted Events (UE)
5. Conduct Risk Assessment (RA)
6. Populate WRAC → show risk priority
7. Select controls + implementation plan
8. Escalate to PIT for execution
9. Monitor control implementation
10. Remote Assurance validates control performance


Vulnerability Module is steps 2–4 and affects everything downstream.

5.2 Approval Workflow
Draft → Pending → Approved → Archived


Downstream availability:

Draft: invisible

Pending: partial visibility

Approved: full pipeline availability

Archived: removed from pipeline

5.3 Watchdog-Driven Reflows

If Watchdog triggers:

Missing relevance → block approval

Updated threat → re-evaluate UE

Updated WRAC → rerun RA consistency

PIT stalled → mark vulnerability mitigation as degraded

6. DATA FLOW DIAGRAM (DFD)
            ┌───────────────┐
            │ Threat Module │
            └───────┬───────┘
                    │ threat list
                    ▼
         ┌────────────────────────┐
         │ Vulnerability Module   │
         │  evidence / tvre / ue  │
         └───────┬───────────────┘
                 │ UEs
                 ▼
         ┌────────────────────────┐
         │ Risk Assessment Engine │
         └───────┬───────────────┘
                 │ RA outputs
                 ▼
         ┌────────────────────────┐
         │ WRAC Module            │
         └───────┬───────────────┘
                 │ controls & cost
                 ▼
           ┌────────────────┐
           │ PIT (Projects) │
           └───────┬────────┘
                   │ progress %
                   ▼
      ┌─────────────────────────────┐
      │ Remote Assurance (future)   │
      └─────────────────────────────┘

7. DATA CONTRACT DETAILS

Contracts specify how modules “talk” to each other.

Each contract formalised in JSON:

Example: Vulnerability → RA

{
  "vulnerability_id": "VUL-0032",
  "ue_id": "UE-112",
  "ra_contribution": {
    "likelihood_modifier": 0.18,
    "impact_modifier": "High",
    "exploitability_score": 0.74
  },
  "timestamp": "2025-01-19T08:22Z"
}


All inter-module data is versioned and immutable.

8. PERMISSIONS & RLS INTEGRATION

Key Rules:

Users only see vulnerabilities in their company

Custodians can approve only items assigned to them

PIT managers see escalated vulnerabilities only

Threat analysts see relevance score mappings

Cross-module RLS is guaranteed via:

shared company_id

row-level constraints

pipeline identity propagation

9. AI INTEGRATION MAP

AI used in:

Classification

Severity suggestion

Evidence analysis

TVRE refinement

UE sentence generation

Node–vulnerability contextual reasoning

Risk narrative generation

AI outputs must always be:

staged

user-approved

logged

AI may never directly commit database changes.

10. WATCHDOG INTEGRATION POINTS

Watchdog monitors:

Missing relevance

Missing custodians

Threat drift changes

UEs not regenerated

RA/WRAC inconsistencies

PIT stalls

Architecture node integrity

Every major change triggers revalidation.

11. EXPORTS INTEGRATION

Exports use:

Vulnerability data

Threat relevance

UE list

RA and WRAC

PIT progress

Evidence bundles

Exports include:

Full pipeline export

Vulnerability registers

UE catalog

TVRE matrix

Architecture vulnerability heatmap

12. ACCEPTANCE CRITERIA FOR INTEGRATION MAP COMPLETENESS

Module is properly integrated when:

All upstream dependencies resolve with no missing data

All downstream exports populate correctly

RA, WRAC, PIT receive correct values

UEs are generated without manual overrides

Watchdog has 0 errors

Architecture nodes are validated

Foreman certifies mapping

✔ END OF VULNERABILITY_INTEGRATION_MAP_v1.0.md