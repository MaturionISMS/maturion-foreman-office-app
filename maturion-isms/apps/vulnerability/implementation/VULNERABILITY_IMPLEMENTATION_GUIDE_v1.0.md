Below is the full VULNERABILITY_IMPLEMENTATION_GUIDE_v1.0.md, aligned with:

VULNERABILITY_TRUE_NORTH_v1.0.md

VULNERABILITY_DATABASE_SCHEMA_v1.1.md

VULNERABILITY_EDGE_FUNCTIONS_v1.1.md

VULNERABILITY_FRONTEND_COMPONENT_MAP_v1.1.md

VULNERABILITY_WIREFRAMES_v1.1.md

VULNERABILITY_QA_IMPLEMENTATION_PLAN_v1.1.md

VULNERABILITY_EXPORT_SPEC_v1.0.md

VULNERABILITY_SPRINT_PLAN_v1.0.md

SRMF full lifecycle (Threat → Vulnerability → UE → RA → WRAC → PIT → Remote Assurance)

Maturion Implementation Philosophy (One-Time-Build, Zero Regression)

This is the canonical builder’s guide for the Co-Pilot developers assigned by the Foreman.

Place in:
/Modules/Risk Management/VulnerabilityModule/VULNERABILITY_IMPLEMENTATION_GUIDE_v1.0.md

VULNERABILITY_IMPLEMENTATION_GUIDE_v1.0.md

Vulnerability Module — Implementation Guide
Version: 1.0
Author: Maturion Foreman AI
Purpose: Provide complete Build Instructions for Co-Pilot Engineers

0. INTRODUCTION

This Implementation Guide specifies exactly how to build the Vulnerability Module from start to finish following True North architecture, including:

tech stack

environment setup

backend implementation sequence

frontend implementation sequence

AI integration setup

versioning

testing

deployment

rollback

cross-module verification

This document is mandatory for engineering teams building the module.

1. TECHNOLOGY STACK

The module must be implemented using the Maturion Standard Stack:

1.1 Backend

Supabase (PostgreSQL + RLS)

Edge Functions (Deno or Node-based)

pgvector

Serverless cron jobs

Storage buckets for evidence

1.2 Frontend

Next.js (App Router)

React 18+

TailwindCSS

shadcn/ui component framework

zustand or recoil (state management)

1.3 AI Layer

OpenAI-compatible LLM API

Internal Maturion AI routing (per Model Routing Spec)

Image parsing: Vision model

NLG: Narrative & UE generator models

1.4 Deployment / DevOps

GitHub Actions

Foreman approval workflow

Canary build pipeline

Feature flags

Sentry monitoring

2. CORE IMPLEMENTATION PRINCIPLES
2.1 One-Time Build

Every component built must be:

minimal

deterministic

extendable

reusable in other modules

2.2 Zero Regression

No change may break upstream or downstream modules.

2.3 SRMF Compliance

Must conform to the SRMF pipeline:

Threat → Vulnerability → UE → RA → WRAC → PIT → Remote Assurance

2.4 AI-Assisted, Human-Controlled

AI assists with:

classification

relevance

severity

sentence generation

evidence interpretation

Human remains final approver.

3. IMPLEMENTATION ROADMAP (HIGH-LEVEL)

The full roadmap matches the Sprint Plan:

1. Schema + Architecture Nodes
2. Vulnerability CRUD
3. Evidence Engine + Markup Tools
4. TVRE (Threat–Vulnerability Relevance Engine)
5. UE (Unwanted Event) Engine
6. RA Integration
7. WRAC Integration
8. PIT Integration
9. Watchdog + AI Layer
10. Exports
11. QA + Stabilization
12. Release


Each step has detailed build instructions below.

4. DATABASE IMPLEMENTATION
4.1 Create Schema Objects

Apply VULNERABILITY_DATABASE_SCHEMA_v1.1.sql, including:

vulnerability

vulnerability_version

vulnerability_evidence

vulnerability_markup

vulnerability_custodian

threat_vulnerability_link

unwanted_event

vulnerability_to_ra

vulnerability_to_wrac

vulnerability_watchdog_event

4.2 Apply Indexes

Follow index specification for optimal query performance.

4.3 Enable Row-Level Security

RLS rules per guide:

Analysts: create/edit draft

Custodians: approve

Managers: archive

Viewers: view approved

4.4 Storage Buckets

Create:

bucket: vulnerability-evidence
bucket: vulnerability-markups

5. BACKEND (EDGE FUNCTIONS)

Implement all functions from:
VULNERABILITY_EDGE_FUNCTIONS_v1.1.md

Order:

5.1 Core functions

create

update

submit_for_review

approve

archive

5.2 Architecture Node functions

create/update/delete nodes

5.3 Evidence functions

upload evidence

attach markups

AI analyze evidence

5.4 TVRE functions

evaluate relevance

refresh links

5.5 UE functions

generate UE

rebuild UEs

5.6 RA & WRAC integration

push_to_ra

sync_ra

push_to_wrac

sync_wrac

5.7 PIT integration

flag_for_pit

sync_pit

5.8 Watchdog functions

watchdog_run

validation hooks

5.9 AI pipeline functions

description polish

classification

severity suggestion

UE sentence generator

6. FRONTEND IMPLEMENTATION

All frontend components must follow:
VULNERABILITY_FRONTEND_COMPONENT_MAP_v1.1.md

6.1 Page Structure

Implement pages:

/vulnerability
/vulnerability/[id]
/architecture

6.2 Core Components to Implement First

VulnerabilityListTable

VulnerabilityCreateForm

ArchitectureTreeView

VulnerabilityMetadataPanel

6.3 Evidence Workspace

Implement:

EvidenceGallery

MarkupEditor

EvidenceViewer

Integrate:

evidence upload

markup save

AI suggestions

6.4 TVRE Workspace

Implement:

Threat search

Relevance score view

Validity indicators

Evaluate button

TTP breakdown panel

6.5 UE Workspace

Implement:

UE list

UE editor

AI generation panel

6.6 RA & WRAC Panels

Read-only RA contribution view

WRAC row indicator

6.7 PIT Panel

PIT escalation badge

Control mapping

Export to PIT button

6.8 Watchdog Panel

Alerts list

Severity badges

7. AI INTEGRATION

Follow:
VULNERABILITY_MODEL_ROUTING_SPEC (inherited from Threat model routing)

7.1 AI Entry Points
Location	AI Function
Metadata Panel	classification, severity assist
Description Panel	description polish
Evidence Workspace	analyze_evidence_ai
TVRE Workspace	relevance refinement
UE Workspace	UE sentence generator
7.2 AI Logging

All AI suggestions must be logged via:
vulnerability_log_ai_interaction

7.3 AI Safety

AI must not write directly to database.
All AI outputs require human approval.

8. WORKFLOW IMPLEMENTATION
8.1 Draft → Pending Approval

Rules enforced in UI + backend validation.

8.2 Pending → Approved

Approval requires:

severity set

custodian assigned

threat relevance evaluated

no missing required fields

8.3 Approved → Archived

Archive cascades UE, RA, WRAC, PIT linkages.

9. WATCHDOG IMPLEMENTATION

Follow all rules in:
VULNERABILITY_EDGE_FUNCTIONS_v1.1.md
and
THREAT_WATCHDOG_LOGIC_v1.0.md

Watchdog checks:

missing relevance

missing custodian

missing severity

outdated evidence

broken architecture nodes

inconsistent threat links

UI must show alerts in the Watchdog Panel.

10. EXPORT ENGINE

Implement all exports defined in:
VULNERABILITY_EXPORT_SPEC_v1.0.md

The export engine is shared with all ISMS modules.

Exports include:

PDF

HTML

CSV

JSON

Evidence ZIP packs

Integrate:

vulnerability_detail

vulnerability_register

UE export

RA/WRAC contributions

PIT escalation

TVRE matrix

full pipeline export

11. TESTING & QA

Follow all phases in:
VULNERABILITY_QA_IMPLEMENTATION_PLAN_v1.1.md

Tests required:

11.1 Unit Tests

CRUD operations

TVRE engine

UE generator

Evidence upload

RLS

11.2 Integration Tests

Threat ←→ Vulnerability

Vulnerability → RA

Vulnerability → WRAC

Vulnerability → PIT

Watchdog

11.3 UI Tests

Cypress flows

Accessibility

Error states

Workflow transitions

11.4 AI Safety Tests

Hallucination detection

Misclassification detection

Output sanitization

12. PERFORMANCE OPTIMISATION

Targets:

Architecture tree <150 ms

Vulnerability list <200 ms

TVRE evaluation <80 ms

UE generation <120 ms

Evidence viewer <250 ms

Techniques:

Selective hydration

Optimized SQL

Partial loading

Caching

Pre-indexing

13. DEPLOYMENT

Deployment pipeline:

Run full QA suite

Foreman approves PR

Auto-build via GitHub Actions

Deploy to staging

Smoke test

Deploy to production

Rollback strategy:

Revert to last schema snapshot

Disable impacted feature flags

Restore previous build artifact

14. DOCUMENTATION DELIVERABLES

Required documentation before release:

Changelog v1.0

Developer notes

Admin guide

User manual

API reference

AI model routing notes

15. RELEASE CRITERIA (v1.0)

The Vulnerability Module is eligible for release when:

All sprint deliverables complete

All QA phases passed

Foreman signs off

Watchdog shows 0 critical alerts

No performance bottlenecks

All exports validated

Full pipeline integration proven

✔ END OF VULNERABILITY_IMPLEMENTATION_GUIDE_v1.0.md