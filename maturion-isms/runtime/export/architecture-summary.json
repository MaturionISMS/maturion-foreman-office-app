{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Architecture Summary Export",
  "description": "Compact runtime-ready summary of ISMS architecture for Runtime Maturion context",
  "type": "object",
  "properties": {
    "metadata": {
      "type": "object",
      "properties": {
        "version": {
          "type": "string",
          "description": "Schema version"
        },
        "export_date": {
          "type": "string",
          "format": "date-time",
          "description": "When this export was generated"
        },
        "architecture_version": {
          "type": "string",
          "description": "Current architecture version"
        },
        "export_source": {
          "type": "string",
          "description": "Source of export (e.g., export-runtime-context.py)"
        }
      },
      "required": ["version", "export_date", "architecture_version"]
    },
    "modules": {
      "type": "array",
      "description": "Summary of all ISMS modules",
      "items": {
        "type": "object",
        "properties": {
          "module_id": {
            "type": "string",
            "description": "Module identifier (e.g., ERM, THREAT, VULNERABILITY)"
          },
          "module_name": {
            "type": "string",
            "description": "Full module name"
          },
          "version": {
            "type": "string",
            "description": "Current module version"
          },
          "status": {
            "type": "string",
            "enum": ["active", "deprecated", "planned", "in_development"],
            "description": "Module status"
          },
          "purpose": {
            "type": "string",
            "description": "Brief description of module purpose"
          },
          "database_tables": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of database tables owned by this module"
          },
          "api_endpoints": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "path": {
                  "type": "string"
                },
                "method": {
                  "type": "string",
                  "enum": ["GET", "POST", "PUT", "PATCH", "DELETE"]
                },
                "purpose": {
                  "type": "string"
                }
              },
              "required": ["path", "method"]
            },
            "description": "Summary of API endpoints"
          },
          "ui_routes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "UI routes for this module"
          },
          "dependencies": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Modules this module depends on"
          },
          "dependents": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Modules that depend on this module"
          },
          "compliance_mapping": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Compliance standards this module supports"
          }
        },
        "required": ["module_id", "module_name", "version", "status", "purpose"]
      }
    },
    "integration_contracts": {
      "type": "array",
      "description": "Inter-module integration contracts",
      "items": {
        "type": "object",
        "properties": {
          "contract_id": {
            "type": "string"
          },
          "source_module": {
            "type": "string",
            "description": "Module providing data/functionality"
          },
          "target_module": {
            "type": "string",
            "description": "Module consuming data/functionality"
          },
          "integration_type": {
            "type": "string",
            "enum": ["api_call", "database_join", "event", "shared_component"],
            "description": "Type of integration"
          },
          "data_flow": {
            "type": "string",
            "description": "Description of data being exchanged"
          },
          "breaking_change_risk": {
            "type": "string",
            "enum": ["low", "medium", "high"],
            "description": "Risk of breaking change if contract modified"
          }
        },
        "required": ["contract_id", "source_module", "target_module", "integration_type"]
      }
    },
    "architecture_principles": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Core architecture principles (e.g., One-Time Build, Zero Regression)"
    },
    "module_boundaries": {
      "type": "object",
      "description": "Rules for module boundaries",
      "properties": {
        "strict_separation": {
          "type": "boolean",
          "description": "Whether strict module separation is enforced"
        },
        "allowed_cross_module_access": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "from_module": {
                "type": "string"
              },
              "to_module": {
                "type": "string"
              },
              "access_type": {
                "type": "string",
                "enum": ["api_only", "database_join", "shared_component"]
              },
              "justification": {
                "type": "string"
              }
            }
          },
          "description": "Explicitly allowed cross-module access patterns"
        }
      },
      "required": ["strict_separation"]
    },
    "technology_stack": {
      "type": "object",
      "description": "Technology stack summary",
      "properties": {
        "frontend": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Frontend technologies (e.g., React, TypeScript)"
        },
        "backend": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Backend technologies (e.g., Supabase, Edge Functions)"
        },
        "database": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Database technologies (e.g., PostgreSQL)"
        },
        "ai_models": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "AI models in use"
        }
      }
    },
    "known_issues": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "issue_id": {
            "type": "string"
          },
          "module": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "severity": {
            "type": "string",
            "enum": ["low", "medium", "high", "critical"]
          },
          "status": {
            "type": "string",
            "enum": ["known", "investigating", "planned_fix", "wont_fix"]
          }
        }
      },
      "description": "Known architecture issues or technical debt"
    }
  },
  "required": ["metadata", "modules", "integration_contracts", "architecture_principles"]
}
