Below is the complete VULNERABILITY_EXPORT_SPEC_v1.0.md, aligned with:

VULNERABILITY_TRUE_NORTH_v1.0.md

VULNERABILITY_DATABASE_SCHEMA_v1.1.md

VULNERABILITY_EDGE_FUNCTIONS_v1.1.md

VULNERABILITY_FRONTEND_COMPONENT_MAP_v1.1.md

VULNERABILITY_WIREFRAMES_v1.1.md

WRAC Export Spec

RA Export Spec

PIT Export Spec

SRMF reporting standards

Maturion universal PDF/HTML/CSV export engine design

This is the full and definitive export specification for the Vulnerability Module.

Place in:
/Modules/Risk Management/VulnerabilityModule/VULNERABILITY_EXPORT_SPEC_v1.0.md

VULNERABILITY_EXPORT_SPEC_v1.0.md

Vulnerability Module — Export Specification
Version: 1.0
Aligned with SRMF, WRAC, RA, PIT, and Maturion ISMS Universal Export Framework

0. PURPOSE

This document defines all exportable formats, layouts, structures, and data pipelines required to produce:

Vulnerability Registers

Vulnerability Detail Reports

Architecture Vulnerability Maps

Threat–Vulnerability Matrices

Unwanted Event (UE) Reports

Data Extraction Exports (CSV/JSON)

Evidence Packs

RA Contribution Extracts

WRAC Contribution Extracts

PIT Escalation Export

Cross-module integrated PDFs for full pipelines

The Vulnerability Module is a major feeder into RA, WRAC, PIT—its exports must be:

deterministic

accurate

versioned

human-readable

machine-readable

consistent with other modules

compatible with downstream analytics

1. EXPORT ENGINE PRINCIPLES (Global)

All Vulnerability exports follow the Maturion Export Engine v1.0 rules:

1.1 Multi-format Outputs

PDF

HTML

CSV

JSON (machine-readable)

ZIP bundles (for evidence packs)

1.2 Version:

Every export is tied to:

vulnerability_version_id
threat_version_id (if relevant)
ue_version

1.3 Auditability

All exports logged in:
export_log

1.4 Deterministic Generation

Export content cannot vary between runs for the same versioned item.

1.5 Controlled AI Usage

AI permitted only in:

narrative sections

summaries

interpretations

AI never modifies structured data.

2. LIST OF EXPORT TYPES
1. Vulnerability Register (Full)
2. Vulnerability Register (Filtered)
3. Vulnerability Detail Report
4. Architecture Vulnerability Map
5. Threat–Vulnerability Matrix
6. UE Report (Unwanted Events)
7. RA Contribution Extract
8. WRAC Contribution Extract
9. PIT Escalation Report
10. Evidence Pack Export
11. Cross-Module Integrated Pipeline Export (TV→Vuln→UE→RA→WRAC→PIT)


Each export type is detailed below.

3. EXPORT 1 — VULNERABILITY REGISTER (FULL)
File:

vulnerability_register_full_<company>_<date>.pdf
vulnerability_register_full_<company>_<date>.csv

Purpose:

Master list of all vulnerabilities across the organisation.

Contents:
Field	Description
vulnerability_id	Primary ID
status	draft/pending/approved/archived
title	vulnerability name
category	classification
severity_level	Low/Medium/High/Critical
severity_score	numeric
exploitability_score	numeric
location	architecture node path
custodian	user
threats_linked_count	number
ues_count	number
pit_escalated	yes/no
last_updated	timestamp
version_number	release version
Filters available:

Severity

Status

Node

Custodian

Threat relevance

PIT status

CSV Column Order:
vulnerability_id, status, title, category, subcategory, 
severity_level, severity_score, exploitability_score,
location_node_path, custodian_name, threats_linked,
ues_generated, pit_status, created_at, updated_at

4. EXPORT 2 — VULNERABILITY REGISTER (FILTERED)

Same structure as Export 1, but based on filter criteria chosen in UI:

Filters:

Facility

Process

Lifecycle

Severity

Custodian

Time period

Threat relevance > threshold

PIT escalated only

Formats:

PDF

CSV

5. EXPORT 3 — VULNERABILITY DETAIL REPORT
File:

vulnerability_<id>_detail_report_v<version>.pdf

Purpose:

Comprehensive record of a single vulnerability, suitable for:

Audits

Investigations

Board reports

Insurance submissions

Safety & Ops use

Sections:
5.1 Header & Metadata

Title

ID

Version

Status

Created/approved dates

Custodian details

5.2 Architecture Location

Full hierarchical path

Node metadata

Node criticality

5.3 Description

AI-polished narrative (user-approved)

Root cause (optional future feature)

5.4 Severity Profile

Severity level badge

Severity score breakdown

Exploitability score

Evidence impact weighting

5.5 Evidence Overview

For each file:

thumbnail

description

uploaded by + timestamp

markup overlays embedded in PDF

5.6 Threat Relevance Summary

Includes:

Threats considered

Relevant or not

Relevance score

TTP mapping

Reasoning

5.7 UE Summary

Generated unwanted events

UE sentences

RA IDs

Current risk level

5.8 RA Contribution

Likelihood modifiers

Impact baseline

ALE influence

5.9 WRAC Contribution

Pre-control rating

Current rating

Post-control projected rating

5.10 PIT Linkage

Whether escalated

PIT project ID

Current progress (%)

5.11 Watchdog Notes

Any QC findings

6. EXPORT 4 — ARCHITECTURE VULNERABILITY MAP
File:

architecture_vulnerability_map_<company>.pdf

Purpose:

Visually maps vulnerabilities to the architecture tree.

Includes:

Tree diagram

Facility → process → lifecycle overlays

Severity colouring

Counts per node

Threat relevance density heatmap

7. EXPORT 5 — THREAT–VULNERABILITY MATRIX
File:

threat_vulnerability_matrix_<company>.pdf
threat_vulnerability_matrix_<company>.csv

Matrix Columns:

| Threat | Vulnerability | Relevance Score | Valid? | UEs Generated | Severity | Location |

Uses colour-coded cells for:

Red: Valid & High relevance

Orange: Valid & Medium

Grey: Invalid

This matrix is one of the top-level board outputs.

8. EXPORT 6 — UNWANTED EVENT (UE) REPORT
File:

ue_report_<company>.pdf

Contains:

UE title

Sentence

Source threat

Source vulnerability

UE-level severity

RA output summary

Controls identified

UI allows single UE or bulk export.

9. EXPORT 7 — RA CONTRIBUTION EXTRACT
File:

vulnerability_to_ra_<date>.csv

Contents:

vulnerability_id

ue_id

ra_record_id

likelihood_modifier

exploitability influence

impact baseline

Used for RA audit trails.

10. EXPORT 8 — WRAC CONTRIBUTION EXTRACT
File:

vulnerability_wrac_linkages_<date>.csv

Contents:

vulnerability_id

wrac_row_id

severity

projected residual

cost influence (if available)

11. EXPORT 9 — PIT ESCALATION REPORT
File:

pit_escalation_report_<date>.pdf

Includes:

Vulnerabilities requiring escalation

Severity

Relevant threats

Required controls

Cost estimate

Risk reduction potential

PIT project templates

This report drives planning meetings and budget cycles.

12. EXPORT 10 — EVIDENCE PACK EXPORT
File:

vulnerability_<id>_evidence_pack.zip

Contains:

All raw evidence files

Markup JSON metadata

Thumbnails

Evidence summary.txt

AI insight report.txt (optional)

Used for audit or investigation.

13. EXPORT 11 — FULL PIPELINE EXPORT

Threat → Vulnerability → UE → RA → WRAC → PIT

File:

full_pipeline_export_<company>_<date>.pdf

Purpose:

Provide a single exportable view of the entire SRMF pipeline for a specific:

facility

process

lifecycle

company

risk program

audit cycle

Sections:

Threat summaries

Vulnerability register

TVRE matrices

UE Catalogue

RA ratings

WRAC prioritisation

PIT mitigation plans

Real-time progress

Forward projections

Critical Control environment summary

This is the flagship output used at executive level.

14. EXPORT ARCHITECTURE & DATA FLOW
UI Export Actions 
      ↓
export_request_queue
      ↓
Edge Functions:
  export_vulnerability_register
  export_vulnerability_detail
  export_architecture_map
  export_threat_vuln_matrix
  export_ue_report
  export_ra_linkages
  export_wrac_linkages
  export_pit_escalation
  export_evidence_pack
  export_full_pipeline
      ↓
unified_export_renderer (PDF/HTML/CSV/JSON)
      ↓
export_log 
      ↓
File Storage (signed URLs)

15. WATCHDOG VALIDATION (Before Export)

Exports are blocked if:

Vulnerability missing severity

Missing custodian

Missing threat relevance evaluation

Missing UEs for valid threats

Unresolved workflow

Broken evidence links

User receives a UI error with details.

16. PERFORMANCE TARGETS

Vulnerability register PDF < 3s

Full pipeline report < 7s

Evidence pack ZIP creation < 5s

17. ACCEPTANCE CRITERIA (v1.0)

Export module is complete when:

All 11 export types implemented

All formats functional

Export logs working

Watchdog checks blocking invalid exports

Full pipeline export validated with a real dataset

Board-ready formatting meets standards

Foreman signs off export build

✔ END OF VULNERABILITY_EXPORT_SPEC_v1.0.md