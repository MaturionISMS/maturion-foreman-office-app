Below is the complete VULNERABILITY_WATCHDOG_LOGIC_v1.0.md, aligned with:

VULNERABILITY_TRUE_NORTH_v1.0.md

Threat_WATCHDOG_LOGIC_v1.0.md

VULNERABILITY_DATABASE_SCHEMA_v1.1.md

VULNERABILITY_EDGE_FUNCTIONS_v1.1.md

SRMF full risk pipeline

Maturion Zero Regression & One-Time Build

Cross-module behaviour (Threat → UE → RA → WRAC → PIT → Remote Assurance)

This is the official rulebook and technical specification for the Vulnerability Module’s automated oversight engine.

Place in:
/Modules/Risk Management/VulnerabilityModule/VULNERABILITY_WATCHDOG_LOGIC_v1.0.md

VULNERABILITY_WATCHDOG_LOGIC_v1.0.md

Vulnerability Module — Automated Oversight & Watchdog Logic
Version: 1.0
Maintainer: Foreman (AI)
Purpose: Enforce SRMF workflow integrity, prevent broken pipelines, and ensure risk assessment quality.

0. INTRODUCTION

The Vulnerability Module has a high degree of influence on all downstream components:

Threat → Vulnerability → UE → RA → WRAC → PIT → Remote Assurance


A single defective vulnerability can break:

TVRE integrity

UE generation

RA calculations

WRAC prioritisation

PIT project formation

Real-time risk monitoring

Therefore, the Watchdog subsystem ensures:

Validity

Completeness

Consistency

Continuity

Version integrity

Compliance with SRMF rules

It continuously scans all records and raises alerts at multiple levels.

1. WATCHDOG ARCHITECTURE

The Vulnerability Watchdog consists of:

1.1 Cron Job (Global Scan)

Runs every 30 minutes (configurable).

1.2 Real-time Hooks

Trigger on create/update/approve/archive of any vulnerability.

1.3 Cross-Module Hooks

Triggered when:

threats update

drift recalculations occur

PIT progress updates affect residual risk

1.4 Alert Dispatcher

Writes alerts to vulnerability_watchdog_event table.

1.5 UI Watchdog Panel

Displays all active alerts with severity badges.

1.6 Notification Engine

Emails / in-app messages for high-severity issues.

2. WATCHDOG ALERT LEVELS
Level	Meaning	Action Required
Critical	Breaks SRMF pipeline	Immediate custodian or manager action
High	Risks incorrect RA/WRAC decisions	Must resolve same day
Medium	Reduces accuracy or completeness	Resolve within 3 days
Low	Advisory	Resolve when convenient
3. WATCHDOG RULE SET

The rule set is divided into Core Rules, AI Rules, Architecture Rules, Workflow Rules, TVRE Rules, UE Rules, RA/WRAC Rules, and PIT Rules.

4. CORE VALIDATION RULES
4.1 Missing Severity — Critical

Triggered when:

vulnerability.status = 'pending' OR 'approved'
AND severity IS NULL

4.2 Missing Custodian — Critical

Triggered when severity ≥ High and:

custodian_id IS NULL

4.3 Missing Architecture Location — Critical

No vulnerability may exist without a node assignment.

4.4 Soft-Deleted Evidence Links — High

Evidence file deleted but vulnerability still references it.

5. ARCHITECTURE INTEGRITY RULES
5.1 Orphaned Node — Critical

Vulnerability linked to a deleted node.

5.2 Invalid Node Path — High

Architecture tree path corrupted or cyclic.

5.3 Duplicate Location Assignment — Medium

Vulnerability assigned twice to the same node structure.

6. TVRE (THREAT–VULNERABILITY RELEVANCE ENGINE) RULES
6.1 Missing TVRE Evaluation — Critical

Vulnerability approved without full relevance evaluation.

6.2 Outdated Relevance Score — High

Triggered when:

threat updated

drift updated

vulnerability changed in a way that affects relevance

6.3 Invalid Threat Link — Medium

Threat marked “invalid” but still appears in UE.

6.4 No Relevant Threats Found — Medium / Critical

If:

vulnerability severity ≥ High

no threats linked
This is Critical.
For low-severity vulnerabilities → Medium.

7. UNWANTED EVENT (UE) RULES
7.1 Missing UE Generation — High

If valid threats exist but UEs missing.

7.2 Invalid UE Sentence — Medium

Generated UE contains inconsistent terms or missing context.

7.3 Outdated UE Version — High

Threat or vulnerability version changed without regenerating UE.

7.4 Multiple UE Version Conflicts — High

More than one UE for the same threat-vulnerability pair marked as “active.”

8. RA INTEGRATION RULES
8.1 Missing RA Linkage — Critical

If a UE is approved but no RA record was created.

8.2 Incorrect RA Severity Mapping — High

Mismatch between vulnerability severity and RA contribution.

8.3 Outdated RA Values After TVRE Change — High

Relevance influences likelihood; must recalc RA.

9. WRAC INTEGRATION RULES
9.1 Missing WRAC Mapping — High

UE with RA rating but no WRAC row.

9.2 Outdated WRAC Scores — Medium

Risk matrix changed (likelihood/impact/appetite) but WRAC not updated.

10. PIT INTEGRATION RULES
10.1 High-Severity Vulnerability Not Escalated — High

If:

severity = High or Critical
AND no PIT project

10.2 PIT Progress Not Reflected — Medium

Residual risk reduction calculations out of date.

10.3 PIT Project Stalled — High

No progress updates > 7 days.

11. AI-RELATED ALERTS
11.1 AI Description Mismatch — Medium

AI-generated summary differs materially from metadata.

11.2 AI Classification Low Confidence — Low

Confidence <30%.

11.3 AI UE Sentence Coherence Issues — Medium

Detected using coherence checker.

12. WATCHDOG ALERT OUTPUT FORMAT

Stored in table:
vulnerability_watchdog_event

Fields:

Field	Description
id	unique
vulnerability_id	target
rule_code	identifier
severity	critical
message	human-readable summary
details	structured JSON
created_at	timestamp
resolved	boolean
resolved_by	user
resolved_at	timestamp
13. UI DISPLAY RULESET
Badge Colours:
Critical — Red
High — Orange
Medium — Yellow
Low — Blue

Sorting:

Critical → High → Medium → Low
Newest → Oldest

Interaction:

Click = opens detail

“Resolve” requires comment

“Archive Alert” requires custodian

14. RESOLUTION WORKFLOW

Critical alerts require:

Custodian OR Manager acknowledgment

Immediate fix

Auto-recheck by Watchdog

High alerts require:

Same-day resolution

Watchdog confirms within 30 min

Medium/Low alerts can be batched.

15. NOTIFICATION LOGIC

Emails/In-app notifications sent when:

Critical alert created

More than 5 High alerts active

Same alert remains unresolved >24h

PIT escalation required

16. SYSTEM FAILSAFE BEHAVIOUR

If Watchdog detects:

16.1 Pipeline Break Risk

(e.g., no RA record for an approved UE)
→ Block further approvals
→ Notify Manager

16.2 Corrupted Node Tree

→ Lock architecture editor
→ Forced admin review

16.3 UE/RA/WRAC Mismatch

→ Mark items “stale”
→ Require regeneration

17. WATCHDOG TECHNICAL IMPLEMENTATION
17.1 Cron Function: vulnerability_watchdog_scan()

Runs validation across all vulnerabilities.

17.2 Trigger Functions

After insert/update on vulnerability tables

After updates to threats

After updates to PIT tables

17.3 Resolution Handler

Function resolve_watchdog_alert() records manual closure.

17.4 Auto-Regeneration Hooks

If rule permits auto-repair (e.g., outdated UE):
auto_regenerate_ue() may run.

18. ACCEPTANCE CRITERIA (v1.0)

Watchdog logic is complete when:

All 54 rules implemented

Alerts appear correctly

Resolution workflow functional

Auto-regeneration works

CI checks pass all logic tests

Foreman signs off

✔ END OF VULNERABILITY_WATCHDOG_LOGIC_v1.0.md